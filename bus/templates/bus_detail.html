{% extends "base.html" %}
{% block title %}SMART BUS - Custom Page Title{% endblock %}
{% block content %}
{% load static %}

<div class="Bus-Details padding-bt">
    <div class="osahan-header-nav shadow-sm p-3 d-flex align-items-center bg-danger">
       <h5 class="font-weight-normal mb-0 text-white">
          <a class="text-danger mr-3" href="{% url 'route_plan' %}"><i class="icofont-rounded-left"></i></a>
          Bus Details - {{ request.GET.stop_name }}
       </h5>
       <div class="ml-auto d-flex align-items-center">
          <a class="toggle osahan-toggle h4 m-0 text-white ml-auto" href="#"><i class="icofont-navigation-menu"></i></a>
       </div>
    </div>

    <div class="p-3">
      <form method="GET" action="">
          {% csrf_token %}
          <div class="form-group">
              <label class="text-muted f-10 mb-1" for="stop_name">Stop Name:</label>
              <input type="text" class="form-control" id="stop_name" name="stop_name" aria-label="Stop Name" value="{{ request.GET.stop_name }}"><br>
              <button type="submit" class="btn btn-danger btn-block osahanbus-btn rounded-1">Search</button>
          </div>
          
          <div class="form-group">
              <label for="bus-select">Select a Bus:</label>
              <select name="bus_id" id="bus-select" class="form-control" onchange="this.form.submit()">
                  <option value="">Select a Bus</option>
                  {% for bus in buses %}
                      <option value="{{ bus.bus_id }}">{{ bus.bus_id }}</option>
                  {% endfor %}
              </select>
          </div>
          <button type="submit" class="btn btn-danger btn-block osahanbus-btn mb-3 rounded-1 mt-4" style="display: none;">VIEW REVIEW</button>
      </form>
  
   </form>

   <!-- Details -->
   <div class="list_item m-0 bg-white">
      <div class="px-3 py-3 tic-div border-bottom d-flex">
         <img src="{% static 'img/listing/item1.png' %}" class="img-fluid border rounded p-1 shape-img mr-3">
         <div class="w-100">
            <h6 class="my-1 l-hght-18 font-weight-bold">{{ request.GET.bus_id }}</h6>
            
            {% if max_rating == 5 %}
            <div class="start-rating f-10">
               <i class="icofont-star text-danger"></i>
               <i class="icofont-star text-danger"></i>
               <i class="icofont-star text-danger"></i>
               <i class="icofont-star text-danger"></i>
               <i class="icofont-star text-danger"></i>
               <span class="text-dark">{{ max_rating }} / 5</span>
               <div class="d-flex mt-2">
                  <p class="m-0"><i class="icofont-google-map mr-1 text-danger"></i><span class="small">{{ stop_point }}</span></p>
                  <p class="small ml-auto mb-0"><i class="icofont-bus mr-1 text-danger"></i> Likely to be very Early</p>
               </div>
            </div>
            {% elif max_rating == 4 %}
            <div class="start-rating f-10">
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-muted"></i>
             <span class="text-dark">{{ max_rating }} / 5</span>
             <div class="d-flex mt-2">
                <p class="m-0"><i class="icofont-google-map mr-1 text-danger"></i><span class="small">{{ stop_point }}</span></p>
                <p class="small ml-auto mb-0"><i class="icofont-bus mr-1 text-danger"></i> Somewhat Early</p>
             </div>
          </div>

          {% elif max_rating == 3 %}
            <div class="start-rating f-10">
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-danger"></i>
             <i class="icofont-star text-muted"></i>
             <i class="icofont-star text-muted"></i>
             <span class="text-dark">{{ max_rating }} / 5</span>
             <div class="d-flex mt-2">
                <p class="m-0"><i class="icofont-google-map mr-1 text-danger"></i><span class="small">{{ stop_point }}</span></p>
                <p class="small ml-auto mb-0"><i class="icofont-bus mr-1 text-danger"></i> On Time</p>
             </div>
          </div>
          {% elif max_rating == 2 %}
          <div class="start-rating f-10">
           <i class="icofont-star text-danger"></i>
           <i class="icofont-star text-danger"></i>
           <i class="icofont-star text-muted"></i>
           <i class="icofont-star text-muted"></i>
           <i class="icofont-star text-muted"></i>
           <span class="text-dark">{{ max_rating }} / 5</span>
           <div class="d-flex mt-2">
              <p class="m-0"><i class="icofont-google-map mr-1 text-danger"></i><span class="small">{{ stop_point }}</span></p>
              <p class="small ml-auto mb-0"><i class="icofont-bus mr-1 text-danger"></i>Somewhat Late</p>
           </div>
        </div>
        {% elif max_rating == 1 %}
          <div class="start-rating f-10">
           <i class="icofont-star text-danger"></i>
           <i class="icofont-star text-muted"></i>
           <i class="icofont-star text-muted"></i>
           <i class="icofont-star text-muted"></i>
           <i class="icofont-star text-muted"></i>
           <span class="text-dark">{{ max_rating }} / 5</span>
           <div class="d-flex mt-2">
              <p class="m-0"><i class="icofont-google-map mr-1 text-danger"></i><span class="small">{{ stop_point }}</span></p>
              <p class="small ml-auto mb-0"><i class="icofont-bus mr-1 text-danger"></i>Late</p>
           </div>
        </div>
            {% else %}
     {% endif %}
      
         </div>
      </div>
      
   </div>
   <ul class="nav nav-pills mb-0 nav-justified bg-white px-3 py-2 border-top border-bottom" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
         <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true"><i class="icofont-info-circle"></i> Info</a>
      </li>
      <li class="nav-item" role="presentation">
         <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false"><i class="icofont-star"></i> Review</a>
      </li>
      <li class="nav-item" role="presentation">
         <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false"><i class="icofont-history"></i> Pick Up</a>
      </li>
   </ul>
   <div class="tab-content" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
         <div class="bus-details pt-3 pb-0 px-3">
            <div class="info" id="info">
               <h6 class="font-weight-normal">About Bus <b>{{ selected_bus.bus_id }}</h6>
               <p class="text-muted small mb-3">This is run by both First Bus and Stage Coach.</p>
            </div>
         </div>
      </div>
      <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
         <div class="bus-details pt-3 pb-0 px-3">

               <div class="comments mt-3">
                  {% for review in top_three_reviews %} 
                  <div class="reviews bg-white p-3 shadow-sm rounded-1 mb-3">
                     <div class="d-flex align-items-center mb-2">
                        <img src="{% static 'img/user1.png' %}" style="width: 24px; height: 24px; class="img-fluid rounded-circle">
                        <div class="ml-2">
                           <p class="mb-0 small font-weight-bold">{{ review.full_name }}</p>
                           <div class="start-rating d-flex align-items-center f-8">
                              <i class="icofont-star text-danger"></i>
                              <i class="icofont-star text-danger"></i>
                              <i class="icofont-star text-danger"></i>
                              <i class="icofont-star text-danger"></i>
                              <i class="icofont-star text-muted"></i>
                              <span class="ml-2 small text-danger">Good</span>
                           </div>
                        </div>
                        <div class="date ml-auto mb-auto small">
                           <small class="f-10">{{ review.timestamp|date:"d/m/Y" }}</small>
                        </div>
                     </div>
                     <p class="small text-muted mb-0">{{ review.comment }}</p>
                  </div>
                  {% endfor %}
               </div>
            </div>
         </div>
      </div>
      <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
         <div class="bus-details pt-3 pb-0 px-3">
            <!-- Pick Up Point -->
            <div class="pickpoint" id="pick">
               <div class="bg-white shadow-sm rounded-1 p-3 mb-3">
                  <h6 class="border-bottom pb-3 mb-3">Boarding Point Selected</h6>
                  {% for pickup in pickups %} 
                  <div class="custom-control custom-radio custom-control-inline">
                     <input type="radio" id="customRadiopick1" name="customRadiopick1" class="custom-control-input" checked>
                     <label class="custom-control-label small d-flex" for="customRadiopick1">
                        <p class="h6 mr-4 mb-0">{{ pickup.arrival_time }}</p>
                       
                     </label>
                  </div>{% endfor %}
               </div>
               
            </div>
         </div>
      </div>
   </div>
 </div>

</div>
</div>
</div>
</div>


{% endblock %}
{% extends 'base1.html' %}

{% block content %}
<style>
    /* Style for radio buttons */
    .radio-rating {
        display: flex;
        gap: 20px; /* Adjust as needed for spacing between radio buttons */
    }
    
    .radio-rating input[type="radio"] {
        display: inline-block;
        margin-top: 20px;
    }
    
    .radio-rating label {
        font-size: 15px; /* Adjust the size as needed */
        cursor: pointer;
        margin-right: 10px;
    
    }
    
    /* Style for the tooltip (title attribute) */
    .radio-rating label::before {
        content: attr(title);
        display: none;
        position: absolute;
        background: #000;
        color: #fff;
        padding: 4px px;
        border-radius: 4px;
        top: 10px; /* Adjust the position as needed */
        left: 50%;
        transform: translateX(-50%);
        z-index: 1;
        white-space: nowrap;
    }
    
    .radio-rating label:hover::before {
        display: block;
    }
    
</style>
<div class="container-fluid">
    <div class="container-fluid">
      <div class="card">
        <div class="card-body">
            <h5 class="card-title fw-semibold mb-4">Bus Search Results - {% if stop_points %}{{ stop_points|join:", " }}{% else %}No results{% endif %}</h5>
          <div class="card">
            <div class="card-body">

<form method="GET" action="{% url 'reviews:review_create' %}">
    {% csrf_token %}
    <div class="form-group">
        <label for="stop_name">Stop Name:</label>
        <div class="input-group">
            <input type="text" class="form-control" id="stop_name" name="stop_name" value="{{ request.GET.stop_name }}" aria-label="Stop Name">
        </div>
    </div>
    <div class="form-group mt-2">
        <button type="submit" class="btn btn-primary">Search</button>
    </div>
</form>
<br/>
  {% load crispy_forms_tags %}
  <form method="post" class="custom-form" style="margin-bottom: 10px;">
    {{ form.full_name|as_crispy_field }}
    {% csrf_token %}
    <label for="bus-select">Select a Bus:</label>
   <select name="bus_id" id="bus-select" class="form-control">
    {% for bus in buses %}
      <option value="{{ bus.bus_id }}">{{ bus.bus_id }}</option>
    {% endfor %}
  </select>
   
  <div class="radio-rating">
    <strong> <label for="star5" title="Very Early">
        <input type="radio" id="star5" name="rating" value="5">
        Very Early
    </label>
    <label for="star4" title="Somewhat Early">
        <input type="radio" id="star4" name="rating" value="4">
        Somewhat Early
    </label>
    <label for="star3" title="On Time">
        <input type="radio" id="star3" name="rating" value="3">
        On Time
    </label>
    <label for="star2" title="Somewhat Late">
        <input type="radio" id="star2" name="rating" value="2">
        Somewhat Late
    </label>
    <label for="star1" title="Late">
        <input type="radio" id="star1" name="rating" value="1">
        Late
    </label>
</div>
<br>

    {{ form.comment|as_crispy_field }}
    <button class="btn btn-primary" type="submit">Submit</button>
  </form>
  <style>
    /* Add spacing to form fields */
    .custom-form .form-group {
      margin-bottom: 10px; /* Adjust as needed */
    }
  </style>
 
  <script>
    const starRatingInputs = document.querySelectorAll('.star-rating input[type="radio"]');
    const ratingField = document.querySelector('#id_rating');

    starRatingInputs.forEach(input => {
        input.addEventListener('click', () => {
            ratingField.value = input.value;
        });
    });
</script>

<script>
    // JavaScript code to populate bus options based on selected stop point
    const stopPointSelect = document.querySelector("#id_stop_point");
    const busIdSelect = document.querySelector("#id_bus_id");

    stopPointSelect.addEventListener("change", () => {
        const stopPointId = stopPointSelect.value;
        busIdSelect.innerHTML = ""; // Clear current options

        // Fetch bus options based on selected stop point and populate the busIdSelect
        fetch(`/get_buses/${stopPointId}/`)
            .then(response => response.json())
            .then(data => {
                data.forEach(bus => {
                    const option = document.createElement("option");
                    option.value = bus.id;
                    option.textContent = bus.bus_id;
                    busIdSelect.appendChild(option);
                });
            });
    });
</script>


{% endblock %}
